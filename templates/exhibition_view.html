<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Webpage Title -->
    <title>회원가입 페이지</title>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <!-- Bulma CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css"
    />
      <!-- Cookie -->
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>

      <!--------------CSS---------------->
      <link rel="stylesheet" href="../static/login.css"/>
      <!-- Bootstrap CSS -->
      <link
              rel="stylesheet"
              href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
              integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
              crossorigin="anonymous"
      />
      <!-- Optional JavaScript -->
      <!-- jQuery first, then Popper.js, then Bootstrap JS -->
      <script
              src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
              integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
              crossorigin="anonymous"
      ></script>
      <script
              src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
              integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
              crossorigin="anonymous"
      ></script>
      <!--------------CSS---------------->
      <link rel="stylesheet" href="../static/exhibition_view.css"/>
        <script type="text/javascript" src="../static/exhibition.js"></script>
  </head>
      <style>
          * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;

      }

          .wrapper {
          width: 600px;
          margin: 0 auto;
      }

          nav {
          width: 100%;
          display: grid;
          grid-template-columns: 500px 200px;
          text-align: center;

          padding: 10px 0;
      }

          nav > ul {
          display: flex;
          justify-content: space-around;
      }

          li {
          list-style: none;
      }

          .exhibition-box {
          margin: 0 auto;
          background-color: antiquewhite;
          padding: 30px 30px;
      }

          .exhibition-info {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
      }

          .thumnail {
          display: flex;
          justify-content: center;
      }

          .thumnail img {
          width: 80%;
      }

          .exhibition-info > li > p {
          font-size: 15px;
      }

          .exhibition-info h5 {
          margin-bottom: 40px;
      }

          button {
          border: 0;
          outline: none;
          margin: 20px auto;
          padding: 5px 10px;
          background-color: rosybrown;
          border-radius: 5px;
          color: #fff;
          cursor: pointer;
      }


          /* REVIEW */
          .review-board {
              width: 100%;
          background-color: #ffffff;
          margin-top:20px;border-radius: 10px;
          border: 1px solid #222222;
      }
          .review-board:first-child{
              margin: 0;
          }

          .review-board > ul {
              width: 100%;
          {#padding: 10px 0;#}
      }

          .user {
          width: 20%;
          padding-left: 10px;
          box-sizing: border-box;
      }

      {#    .review-content > ul > li:nth-child(1) {#}
      {#    display: flex;#}
      {#    flex-direction: row;#}
      {#    text-align: end;#}
      {#}#}

          .review-content {
          margin: auto;
          width: 90%;
          background-color: lightpink;
          border-radius: 10px;
          border: 1px solid #222222;
      }
          .upload-btn {
              border: 0;
              outline: 0;
              border-radius: 10px;
              background-color: #fdd93a;
              cursor: pointer;
          }


          .delbtn {
              border: 0;
              outline: 0;
              border-radius: 10px;
              background-color: #fdd93a;
              cursor: pointer;
          }


          .likebtn {
              border: 0;
              outline: 0;
              border-radius: 10px;
              background-color: var(--button-color);
              cursor: pointer;

          }
            .review-wrap{
                position: relative;padding: 15px 15px 10px;
            }
          .review-wrap .grade{
              display: flex;
              width: 100%;
          }
          .review-wrap .grade > span{
              width: 50%;flex: 0 0 50%;
          }
          .review-wrap .grade > span:last-child{
              text-align:right;
          }
          .review-wrap .comment{
              display: flex;
            width: 100%;height: auto;padding-bottom: 30px;margin-top:10px;
          }
          .review-wrap .comment .title{
              flex: 0 0 50px;
              font-size: 16px;font-weight: normal;
          }
          .review-wrap .comment .text{
              flex: 0 0 calc(100% - 50px);
          }
          .review-wrap .like{
              position: absolute;right: 15px;bottom: 0;
          }
          .review-wrap .like button{
              margin: 0;
          }

          .testt {

              position: relative;

              width: 100vw;

              {#height: 100vh;#}

              overflow: hidden;

              background: #E08183 url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiIHdpZHRoPSI3OTguNzAycHgiIGhlaWdodD0iNzk4LjcwMnB4IiB2aWV3Qm94PSIwIDAgNzk4LjcwMiA3OTguNzAyIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCA3OTguNzAyIDc5OC43MDIiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxnPjxyZWN0IGZpbGw9IiNFMDgyODMiIHdpZHRoPSI3OTguNzAyIiBoZWlnaHQ9Ijc5OC43MDIiLz48Zz48cGF0aCBmaWxsPSIjRTY5QzlEIiBkPSJNMTcxLjMzOSwxODAuMDUxaC02OS4xODVjLTYuNjE4LDAtMTIuMDMzLDUuNDE0LTEyLjAzMywxMi4wMzJ2MjIuNTZjMCw2LjYxOCw1LjQxNSwxMi4wMzMsMTIuMDMzLDEyLjAzM2g2OS4xODVjNi42MTcsMCwxMi4wMzItNS40MTUsMTIuMDMyLTEyLjAzM3YtMjIuNTZDMTgzLjM3MiwxODUuNDY1LDE3Ny45NTcsMTgwLjA1MSwxNzEuMzM5LDE4MC4wNTF6Ii8+PHBhdGggZmlsbD0iI0U2OUM5RCIgZD0iTTIwMi44ODcsMTIzLjM3Nmg2OS4xODVjNi42MTgsMCwxMi4wMzMtNS40MTQsMTIuMDMzLTEyLjAzMnYtMjIuNTZjMC02LjYxOS01LjQxNS0xMi4wMzMtMTIuMDMzLTEyLjAzM2gtNjkuMTg1Yy02LjYxNywwLTEyLjAzMiw1LjQxNC0xMi4wMzIsMTIuMDMzdjIyLjU2QzE5MC44NTQsMTE3Ljk2MiwxOTYuMjcsMTIzLjM3NiwyMDIuODg3LDEyMy4zNzZ6Ii8+PHBhdGggZmlsbD0iI0U2OUM5RCIgZD0iTTIxNy45NjQsMTI3LjcxMmgtNjkuMTg1Yy02LjYxOCwwLTEyLjAzMyw1LjQxNS0xMi4wMzMsMTIuMDMydjIyLjU2MWMwLDYuNjE4LDUuNDE1LDEyLjAzMiwxMi4wMzMsMTIuMDMyaDY5LjE4NWM2LjYxOCwwLDEyLjAzMi01LjQxNSwxMi4wMzItMTIuMDMydi0yMi41NjFDMjI5Ljk5NiwxMzMuMTI3LDIyNC41ODIsMTI3LjcxMiwyMTcuOTY0LDEyNy43MTJ6Ii8+PHBhdGggZmlsbD0iI0U2OUM5RCIgZD0iTTEyOS43MywxNjIuMzA1di0yMi41NjFjMC02LjYxOC01LjQxNS0xMi4wMzItMTIuMDMyLTEyLjAzMkg0OC41MTNjLTYuNjE4LDAtMTIuMDMyLDUuNDE1LTEyLjAzMiwxMi4wMzJ2MjIuNTYxYzAsNi42MTgsNS40MTQsMTIuMDMyLDEyLjAzMiwxMi4wMzJoNjkuMTg2QzEyNC4zMTYsMTc0LjMzNywxMjkuNzMsMTY4LjkyMywxMjkuNzMsMTYyLjMwNXoiLz48cGF0aCBmaWxsPSIjRTY5QzlEIiBkPSJNNTE1LjYwNCwxMDcuOTIxdjIyLjU2MWMwLDYuNjE4LDUuNDE1LDEyLjAzMiwxMi4wMzIsMTIuMDMyaDY5LjE4NmM2LjYxOCwwLDEyLjAzMi01LjQxNSwxMi4wMzItMTIuMDMydi0yMi41NjFjMC02LjYxOC01LjQxNC0xMi4wMzItMTIuMDMyLTEyLjAzMmgtNjkuMTg2QzUyMS4wMTksOTUuODg5LDUxNS42MDQsMTAxLjMwMyw1MTUuNjA0LDEwNy45MjF6Ii8+PHBhdGggZmlsbD0iI0U2OUM5RCIgZD0iTTYyNy4zNjgsMTQyLjUxNGg2OS4xODVjNi42MTgsMCwxMi4wMzQtNS40MTUsMTIuMDM0LTEyLjAzMnYtMjIuNTYxYzAtNi42MTgtNS40MTYtMTIuMDMyLTEyLjAzNC0xMi4wMzJoLTY5LjE4NWMtNi42MTksMC0xMi4wMzIsNS40MTUtMTIuMDMyLDEyLjAzMnYyMi41NjFDNjE1LjMzNSwxMzcuMDk5LDYyMC43NDksMTQyLjUxNCw2MjcuMzY4LDE0Mi41MTR6Ii8+PHBhdGggZmlsbD0iI0U2OUM5RCIgZD0iTTU3NC4yNjEsMTU1LjI4NGMtNi42MTcsMC0xMi4wMzEsNS40MTUtMTIuMDMxLDEyLjAzM3YyMi41NjFjMCw2LjYxNyw1LjQxNCwxMi4wMzIsMTIuMDMxLDEyLjAzMmg2OS4xODdjNi42MTcsMCwxMi4wMzEtNS40MTUsMTIuMDMxLTEyLjAzMnYtMjIuNTYxYzAtNi42MTgtNS40MTQtMTIuMDMzLTEyLjAzMS0xMi4wMzNINTc0LjI2MXoiLz48cGF0aCBmaWxsPSIjRTY5QzlEIiBkPSJNMzU0LjIwMyw0MTMuMDR2LTIyLjU2MWMwLTYuNjE4LTUuNDE0LTEyLjAzMi0xMi4wMzItMTIuMDMyaC02OS4xODZjLTYuNjE3LDAtMTIuMDMyLDUuNDE1LTEyLjAzMiwxMi4wMzJ2MjIuNTYxYzAsNi42MTcsNS40MTUsMTIuMDMyLDEyLjAzMiwxMi4wMzJoNjkuMTg2QzM0OC43ODksNDI1LjA3MiwzNTQuMjAzLDQxOS42NTcsMzU0LjIwMyw0MTMuMDR6Ii8+PHBhdGggZmlsbD0iI0U2OUM5RCIgZD0iTTQ0MS45MDEsMzc4LjQ0N2gtNjkuMTg1Yy02LjYxOSwwLTEyLjAzMiw1LjQxNS0xMi4wMzIsMTIuMDMydjIyLjU2MWMwLDYuNjE3LDUuNDEzLDEyLjAzMiwxMi4wMzIsMTIuMDMyaDY5LjE4NWM2LjYxOCwwLDEyLjAzNC01LjQxNSwxMi4wMzQtMTIuMDMydi0yMi41NjFDNDUzLjkzNSwzODMuODYxLDQ0OC41MTksMzc4LjQ0Nyw0NDEuOTAxLDM3OC40NDd6Ii8+PHBhdGggZmlsbD0iI0U2OUM5RCIgZD0iTTM4OC43OTYsNDM3Ljg0MkgzMTkuNjFjLTYuNjE3LDAtMTIuMDMxLDUuNDE0LTEyLjAzMSwxMi4wMzN2MjIuNTYxYzAsNi42MTcsNS40MTQsMTIuMDMxLDEyLjAzMSwxMi4wMzFoNjkuMTg3YzYuNjE3LDAsMTIuMDMxLTUuNDE0LDEyLjAzMS0xMi4wMzF2LTIyLjU2MUM0MDAuODI4LDQ0My4yNTYsMzk1LjQxNCw0MzcuODQyLDM4OC43OTYsNDM3Ljg0MnoiLz48cGF0aCBmaWxsPSIjRTY5QzlEIiBkPSJNNzQzLjE3Nyw2NTYuMTg4aC02OS4xODVjLTYuNjE5LDAtMTIuMDMzLDUuNDE1LTEyLjAzMywxMi4wMzJ2MjIuNTZjMCw2LjYyLDUuNDE0LDEyLjAzMiwxMi4wMzMsMTIuMDMyaDY5LjE4NWM2LjYxNywwLDEyLjAzMy01LjQxMiwxMi4wMzMtMTIuMDMydi0yMi41NkM3NTUuMjEsNjYxLjYwMyw3NDkuNzk0LDY1Ni4xODgsNzQzLjE3Nyw2NTYuMTg4eiIvPjxwYXRoIGZpbGw9IiNFNjlDOUQiIGQ9Ik02OTYuNTUyLDcxMS4zMzNoLTY5LjE4NWMtNi42MTksMC0xMi4wMzIsNS40MTUtMTIuMDMyLDEyLjAzMnYyMi41NjFjMCw2LjYxNyw1LjQxMywxMi4wMzEsMTIuMDMyLDEyLjAzMWg2OS4xODVjNi42MTgsMCwxMi4wMzEtNS40MTQsMTIuMDMxLTEyLjAzMXYtMjIuNTYxQzcwOC41ODMsNzE2Ljc0OCw3MDMuMTcsNzExLjMzMyw2OTYuNTUyLDcxMS4zMzN6Ii8+PHBhdGggZmlsbD0iI0U2OUM5RCIgZD0iTTU5Ni44MjIsNzExLjMzM2gtNjkuMTg2Yy02LjYxNywwLTEyLjAzMiw1LjQxNS0xMi4wMzIsMTIuMDMydjIyLjU2MWMwLDYuNjE3LDUuNDE1LDEyLjAzMSwxMi4wMzIsMTIuMDMxaDY5LjE4NmM2LjYxOCwwLDEyLjAzMi01LjQxNCwxMi4wMzItMTIuMDMxdi0yMi41NjFDNjA4Ljg1NCw3MTYuNzQ4LDYwMy40NCw3MTEuMzMzLDU5Ni44MjIsNzExLjMzM3oiLz48cGF0aCBmaWxsPSIjRTY5QzlEIiBkPSJNNTU0LjkyNiw3OS41OTdWNTcuMDM2YzAtNi42MTctNS40MTUtMTIuMDMyLTEyLjAzMi0xMi4wMzJoLTY5LjE4N2MtNi42MTcsMC0xMi4wMzEsNS40MTUtMTIuMDMxLDEyLjAzMnYyMi41NjFjMCw2LjYxOCw1LjQxNCwxMi4wMzIsMTIuMDMxLDEyLjAzMmg2OS4xODdDNTQ5LjUxMSw5MS42MjksNTU0LjkyNiw4Ni4yMTUsNTU0LjkyNiw3OS41OTd6Ii8+PC9nPjwvZz48L3N2Zz4=) repeat;

              background-size: 30%;

          }


      </style>
      <script>
          $(document).ready(function(){
          })
          {#   현재 날짜 구하기     #}
          function getTime() {
              let today ;
              let d = new Date();

              let s =
                  leadingZeros(d.getFullYear(), 4) + '-' +
                  leadingZeros(d.getMonth() + 1, 2) + '-' +
                  leadingZeros(d.getDate(), 2);

              return s;
          }

          function leadingZeros(n, digits) {
              let zero = '';
              n = n.toString();

              if (n.length < digits) {
                  for (i = 0; i < digits - n.length; i++)
                  zero += '0';
              }
              return zero + n;
          }

          {# 리뷰 작성하기 #}
          function makeReview() {
              let review_date = getTime()
              let grade = parseInt($('#grade').val())
              let comment = $('#comment').val()
              let like = $('#like').val()
                  $.ajax({
                  type: "POST",
                  url: "/api/review",
                  data: {
                      review_exhibition_give: {{ word }},
                      review_grade_give: grade,
                      review_comment_give: comment,
                      review_like_give: like,
                      review_date_give: review_date
                  },
                  success: function (response) {
                      alert(response["msg"]);
                      window.location.href=`/exhibition/{{ word }}`;
                  }
              })
          }

         function deleteReview(idx) {
             console.log(idx)
            $.ajax({
                type: 'GET',
                url: '/delete/idx',
                data: { review_comment_give : idx },
                success: function (response) {
                    alert(response['msg']);
                    window.location.reload()
                },
                error: function (error) {
                    alert(JSON.stringify)
                }
            })
        }

  </script>
  </head>
  <body>
  <div class="testt">
  <div class="wrapper">
      <nav>
          <div class="logo"><a href="/">logo</a></div>
          <ul>
              <a href="/login" class="visitor">
                  <li>로그인</li>
              </a>
              <a href="/register" class ="visitor">
                  <li>회원가입</li>
              </a>
              <li class="customer" id="customer_name">님, 환영합니다!</li>
              <li class="customer"><button onclick="logout()">로그아웃</button></li>

          </ul>
      </nav>
      <section class="exhibition-box" id="card-box">
          {% for content in contents %}
              {% if content.id == word %}
                  <ul class="exhibition-info">
                      <li class="thumnail"><img src="{{ content.img_url }}"/></li>
                      <li>
                          <h5>{{ content.title }}</h5>
                          <p>날짜 : <span>{{ content.period }}</span></p>
                          <p>장소 : <span>{{ content.place }}</span></p>
                          <p>가격 : <span>{{ content.price }}</span> 원</p>

                          <a href="{{ content.url }}">
                              <button>예매하러가기</button>
                          </a>
                      </li>
                  </ul>
              {% endif %}
          {% endfor %}
      </section>
      <section class="review-box">
          <button class="upload-btn" onclick="dologin()">리뷰쓰기</button>
          <div className="reviewWrap" id="reviewform">
          </div>

          <div class="review-average">
              <p>평점 : <span class="average_grade">

    {% set score = [] %}

                  {% for review in reviews %}
                      {% if review.review_exhibition == word %}
                          {% if score.append(review.review_grade) %}{% endif %}
                      {% endif %}
                  {% endfor %}
                  {% set num = score | count-1 %}
                  {% if  score | count == 0 %}
                      {{ (score|count) | round(2) }}
                  {% else %}
                      {% set num  = score | count %}
                      {{ (score | sum /  num) |round(2) }}
                  {% endif %}


</span></p>
          </div>
          {% for review in reviews %}
              {% if review.review_exhibition == word %}
                  <div class="review-board" id="{{ review._id }}">
                      <ul>
                          <li>
                              <ul class="review-wrap">
                                  <li class="grade">
                                      <span>{{ review.review_grade }}</span><span>{{ review.review_date }}</span>
                                  </li>
                                  <li class="comment">
{#                                      <p class="title">내용 : </p>#}
                                      <p class="text">{{ review.review_comment }}</p>
                                  </li>
                                  <li class="like">
                                      <span><button class="likebtn" onclick="likeup()">❤</button></span><span><button class="delbtn" onclick="deleteReview('{{  review.review_comment }}')">삭제</button></span>
                                  </li>
                              </ul>
                          </li>
                      </ul>
                  </div>
              {% endif %}
          {% endfor %}
  </div>
  </section>

  </div>
  </div>

  </body>
</html>
